Token Service:
==============

Service user (SU) requires a token to access a service.
Service provider (SP) provides a token to the SU.
SP obtains a token from the token service (TS).

A token is a random byte sequence that is produced by the TS.
Its origin can be proven.
Only the SP can pass it on to the SU in a usable form.

TS Access Hand Shake
- the SP accesses the TS root
- the TS returns a signed NONCE
- the SP validates the NONCE signature
- the SP signes the NOCNCE and sends it to the TS as a TOKEN request
- the TS verifies the SP signature
Token Exchange
- a random byte sequence is generated by the TS
- the TOKEN is signed by the TS with its private key
- the signed TOKEN is encrypted by the TS with the public key of the SP
- the encrypted signed TOKEN is decrypted by the SP with her private key
- the TS signature is verified by the SP using the public key of the TS
- the decrypted verified TOKEN is signed by the SP with her private key
- the signed verified TOKEN is passed on to the SU
Service Access
- the SU provides the signed verified TOKEN when accessing the service
- the service accesses the TS in order to validate the TOKEN
- the TS verifies the SP signature using the public key of the SP
- the TS verifies that the given TOKEN was produced for the SP
- the TS removes the TOKEN from its active TOKEN storage
- the TS returns OK to the service to indicate that the TOKEN valid
- the service resumes operation

